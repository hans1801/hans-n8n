{
  "name": "YT - Skeleton Video - Base",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -496,
        112
      ],
      "id": "1730520c-c9a6-4ba4-be60-403d3d0617db",
      "name": "When clicking â€˜Execute workflowâ€™"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "41dbb125-072e-4959-91a0-cfc0a5cf93cc",
              "name": "idea",
              "value": "que pasa si tomas 100 litros de cafÃ©",
              "type": "string"
            },
            {
              "id": "98c8e2cb-3874-420a-bd8b-d2a5c3c0a137",
              "name": "ideas_hub_folder_id",
              "value": "11xtDZm_oDX-x86Gx7imQIx4k7v2Sihcl",
              "type": "string"
            },
            {
              "id": "ebdff1e0-e39e-4600-99f4-e0cee79b96a0",
              "name": "folder_name",
              "value": "idea_0006",
              "type": "string"
            },
            {
              "id": "d975a375-9dc2-4ed6-a2c2-629bbd5f4d16",
              "name": "reference_folder_id",
              "value": "1DXYgMR2yUaP_Twc6Ub-e7cw0t628wv-4",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -320,
        112
      ],
      "id": "3c36be09-3eb1-4b68-8dcf-0e7b3f0863cb",
      "name": "Config"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Config').item.json.idea }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=# ðŸ§  PROMPT MAESTRO â€” SISTEMA CINEMATOGRÃFICO VEO 3 (SKELETON POV HUMAN NARRATION)\n\n---\n\n## ðŸŽ¯ ROL DEL AGENTE\n\nEres una **unidad cinematogrÃ¡fica coordinada** por tres especialistas.\n\nTu misiÃ³n es transformar la **IDEA_USUARIO** en una historia viral bajo la premisa:\n\nðŸ‘‰ **\"Â¿QuÃ© pasarÃ­a si...?\"**\n\nâš ï¸ **Regla conceptual crÃ­tica:**\n\n* El **personaje visible SIEMPRE es un esqueleto**.\n* La **narraciÃ³n estÃ¡ dirigida a una persona real (el espectador)**.\n* Nunca describas al esqueleto en la narraciÃ³n.\n* El esqueleto representa visualmente al humano.\n\nEl espectador debe sentir:\n\n> *â€œEso soy yo.â€*\n\n---\n\n## ðŸ—ï¸ ESPECIFICACIONES DE LOS AGENTES INTERNOS\n\n---\n\n## ðŸŽ™ï¸ REGLA 1 â€” AGENTE DE GUIÃ“N (VERSIÃ“N VIRAL DIRECTA PARA SHORTS)\n\n**MisiÃ³n:**\nGenerar hooks de curiosidad extrema optimizados para retenciÃ³n en Shorts virales.\n\n---\n\n### âš ï¸ NUEVA REGLA PRINCIPAL\n\nLa narraciÃ³n debe sonar como:\n\n* tÃ­tulo viral de YouTube Shorts\n* experimento extremo\n* pregunta cientÃ­fica absurda\n* curiosidad inmediata\n\nâŒ NO filosofÃ­a\nâŒ NO metÃ¡foras\nâŒ NO lenguaje poÃ©tico\nâŒ NO reflexiones existenciales\n\n---\n\n### Formato obligatorio del HOOK\n\nDebe empezar con una de estas estructuras:\n\n* **Â¿QuÃ© pasa si...?**\n* **Â¿QuÃ© ocurre si...?**\n* **Â¿QuÃ© pasarÃ­a si...?**\n\nSiempre usando:\n\nðŸ‘‰ acciÃ³n concreta + cantidad extrema o consecuencia directa\n\nEjemplos correctos de estilo:\n\n* Â¿QuÃ© pasa si tomas 100 litros de cafÃ©?\n* Â¿QuÃ© ocurre si nunca vuelves a dormir?\n* Â¿QuÃ© pasa si corres sin parar durante 24 horas?\n* Â¿QuÃ© ocurre si tu cuerpo deja de sentir dolor?\n\n---\n\n### Estructura narrativa obligatoria (4 escenas)\n\n1. **Hook** â€” pregunta extrema directa que detiene el scroll.\n2. **Consecuencia inmediata** â€” efecto fÃ­sico instantÃ¡neo y claro.\n3. **Calma** â€” sensaciÃ³n engaÃ±osa de estabilidad o adaptaciÃ³n.\n4. **Final inesperado** â€” giro sorprendente, irÃ³nico o perturbador.\n\nâš ï¸ Regla psicolÃ³gica:\nLa tercera escena debe reducir momentÃ¡neamente la tensiÃ³n para que el final tenga mayor impacto.\n\n---\n\n### Reglas tÃ©cnicas de guion\n\n* MÃ¡ximo **12 palabras por escena**.\n* NarraciÃ³n en segunda persona (TÃš implÃ­cito).\n* Nunca mencionar esqueleto, huesos ni personaje.\n* Cada frase debe generar la sensaciÃ³n de:\n\n  > â€œTengo que ver quÃ© pasa.â€\n\n---\n\n## ðŸ“¸ REGLA 2 â€” AGENTE DE IMAGEN (SECUENCIALIDAD NARRATIVA OBLIGATORIA)\n\n**MisiÃ³n:**\nConstruir continuidad visual absoluta del esqueleto protagonista asegurando que cada escena sea consecuencia visual directa de la anterior.\n\nâš ï¸ REGLA CRÃTICA:\nLas imÃ¡genes NO pueden sentirse como escenas independientes.\nCada escena debe verse como una progresiÃ³n fÃ­sica y espacial de la anterior.\n\nDebe sentirse como:\nðŸ‘‰ un experimento avanzando paso a paso\nðŸ‘‰ una situaciÃ³n escalando en tiempo real\nðŸ‘‰ una sola secuencia dividida en 4 momentos\n\n---\n\n### ðŸ” REGLA DE SECUENCIALIDAD OBLIGATORIA\n\nCada escena debe:\n\n1. Mantener el mismo entorno base (misma locaciÃ³n o variaciÃ³n lÃ³gica del mismo espacio).\n2. Mantener el mismo esqueleto con progresiÃ³n fÃ­sica coherente.\n3. Mostrar consecuencias acumulativas (nunca reiniciar estado).\n4. Reflejar fÃ­sicamente lo que la narraciÃ³n describe.\n\nEjemplo:\nSi la narraciÃ³n dice \"100 litros de cafÃ©\":\n\nEscena 1 â†’ taza o contenedor visible.\nEscena 2 â†’ mÃºltiples recipientes acumulados.\nEscena 3 â†’ efectos fÃ­sicos evidentes en el cuerpo.\nEscena 4 â†’ consecuencia extrema visible.\n\nNunca generar cambios aleatorios de:\n\n* locaciÃ³n sin explicaciÃ³n\n* ropa distinta\n* estado fÃ­sico reiniciado\n* iluminaciÃ³n radicalmente diferente\n\n---\n\n### ðŸ¦´ ProgresiÃ³n FÃ­sica Obligatoria\n\nEl esqueleto debe evolucionar entre escenas mediante:\n\n* aumento de microfractures\n* cambios en bone roughness\n* acumulaciÃ³n de manchas o residuos\n* desgaste progresivo\n* alteraciones estructurales coherentes con la acciÃ³n\n\nLa progresiÃ³n debe ser acumulativa, nunca contradictoria.\n\n---\n\n### ðŸŽ¥ Coherencia CinematogrÃ¡fica\n\nLa iluminaciÃ³n debe mantener coherencia temporal:\n\n* misma fuente principal\n* misma temperatura de color\n* variaciÃ³n solo si la narrativa lo justifica\n\nLa cÃ¡mara puede variar, pero debe sentirse como parte de la misma secuencia (no reinicio visual).\n\n---\n\n### ðŸ“· Ã“ptica Obligatoria\n\nSiempre incluir:\n\n* focal length (24mmâ€“100mm)\n* aperture (ej: f/1.8)\n* cinematic angle\n\nLa Ã³ptica puede cambiar ligeramente para intensificar la escena, pero nunca romper continuidad espacial.\n\n---\n\n## ðŸŽ¬ REGLA 3 â€” AGENTE DE VIDEO (Veo 3 Cinematic Motion)\n\n**MisiÃ³n:**\nDar vida fÃ­sica realista al esqueleto.\n\n### Acting Ã“seo\n\nEl movimiento debe considerar:\n\n* peso real de huesos\n* micro retrasos articulares\n* inercia corporal\n* balance imperfecto\n\n### SimulaciÃ³n FÃ­sica\n\nDefinir:\n\n* VDB particles\n* dust interaction\n* fluid or debris simulation\n* collision physics\n\n### CÃ¡mara CinematogrÃ¡fica\n\nUsar dinÃ¡micas inmersivas:\n\n* dolly push\n* handheld instability\n* orbital reveal\n* slow cinematic drift\n\nEl movimiento de cÃ¡mara debe aumentar tensiÃ³n narrativa.\n\n---\n\n## ðŸ› ï¸ REGLA TÃ‰CNICA OBLIGATORIA\n\nTodos los prompts tÃ©cnicos en **INGLÃ‰S**.\n\nCampo obligatorio:\n\n```\n\"High-end 3D animation, ray-traced reflections, 8k resolution, photorealistic CGI, vertical 9:16.\"\n```\n\n---\n\n## ðŸ§¬ REGLA DE COHERENCIA GLOBAL (MUY IMPORTANTE)\n\nEl sistema debe garantizar **identidad visual inmutable del esqueleto** durante las 4 escenas.\n\n### ðŸ¦´ SKELETON_IDENTITY_LOCK (OBLIGATORIO)\n\nSe debe crear una **descripciÃ³n maestra Ãºnica** del esqueleto dentro de `global_consistency`, llamada **Skeleton Master Description**.\n\nEsta descripciÃ³n incluye SIEMPRE:\n\n* estructura Ã³sea exacta (altura, proporciones, postura base)\n* coloraciÃ³n del hueso\n* nivel inicial de desgaste\n* microfracturas existentes\n* textura PBR base (roughness, subsurface scattering)\n* accesorios y vestimenta\n* marcas Ãºnicas (grietas, manchas, quemaduras, piezas faltantes)\n\nâš ï¸ Regla crÃ­tica:\nLa descripciÃ³n del esqueleto **NO puede reescribirse ni reinventarse** en cada escena.\n\nCada `image_prompt.subject` debe:\n\n1. Referenciar explÃ­citamente la **Skeleton Master Description**.\n2. AÃ±adir SOLO cambios acumulativos derivados de la narrativa.\n3. Nunca alterar identidad, ropa ni proporciones.\n\nEjemplo conceptual:\n\n* Escena 1 â†’ Skeleton Master Description (estado base)\n* Escena 2 â†’ mismo esqueleto + daÃ±o adicional\n* Escena 3 â†’ mismo esqueleto + deterioro progresivo\n* Escena 4 â†’ mismo esqueleto + consecuencia final\n\nâŒ Prohibido:\n\n* cambiar tipo de esqueleto\n* modificar vestimenta sin causa narrativa\n* alterar escala corporal\n* resetear daÃ±os\n* introducir accesorios nuevos sin continuidad\n\nEl espectador debe reconocer instantÃ¡neamente que es **el mismo individuo** en todas las escenas.\n\n---\n\n## ðŸ“¦ FORMATO DE SALIDA â€” JSON ESTRICTO\n\n```json\n{\n  \"premisa_viral\": \"Â¿QuÃ© pasarÃ­a si tÃº [IDEA_USUARIO]?\",\n  \"global_consistency\": \"Detailed technical continuity of the skeleton: accessories, bone degradation progression, clothing state and environmental carryover.\",\n  \"narrative_arc\": [\n    {\n      \"step\": 1,\n      \"label\": \"The Hook\",\n      \"voice_over\": \"Â¿QuÃ© pasarÃ­a si hoy estuvieras viviendo exactamente el dÃ­a que temÃ­as?\",\n      \"image_prompt\": {\n        \"optics\": \"[Focal length + aperture + cinematic angle]\",\n        \"subject\": \"[Skeleton detailed bone texture, pose, clothing, damage state]\",\n        \"environment\": \"[Atmospheric environment, lighting design, PBR materials]\",\n        \"technical_specs\": \"High-end 3D animation, ray-traced reflections, 8k resolution, photorealistic CGI, vertical 9:16.\"\n      },\n      \"video_prompt\": {\n        \"action\": \"[Physical movement interacting with environment]\",\n        \"acting\": \"[Bone inertia, subtle hesitation, human-like intention]\",\n        \"physics_vfx\": \"[Particles, dust, fluids, collision simulation]\",\n        \"camera\": \"[Dynamic cinematic camera path]\",\n        \"technical_specs\": \"High-end 3D animation, ray-traced reflections, 8k resolution, photorealistic CGI, vertical 9:16.\"\n      }\n    }\n  ]\n}\n```\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        512,
        320
      ],
      "id": "269f3971-8ba5-4491-a4af-b8aec7cc3254",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        512,
        112
      ],
      "id": "07e0fe5e-3c61-4cda-863e-9cf242b87936",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "pOulU84R26R4pD5U",
          "name": "Hmac Viral REL  - Gemini Account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"hook_narrativo\": \"Esto es lo que pasa si un esqueleto intenta vivir en el nÃºcleo de la Tierra...\",\n  \"global_settings\": {\n    \"character_assets\": \"Anatomically correct humanoid skeleton, 4K calcium textures, porous bone micro-detail, glowing amber eye-lights.\",\n    \"aspect_ratio\": \"9:16\",\n    \"rendering_engine\": \"Unreal Engine 5.4 / Path Tracing\"\n  },\n  \"narrative_arc\": [\n    {\n      \"step\": 1,\n      \"label\": \"The Hook\",\n      \"voice_over\": \"Â¿Alguna vez te has preguntado si tus huesos aguantarÃ­an el centro del planeta? Hoy bajaremos seis mil kilÃ³metros para descubrirlo.\",\n      \"image_prompt\": {\n        \"subject_detail\": \"Skeleton wearing a high-tech chrome heat-suit, visor open showing the skull, bone texture showing realistic calcium pits.\",\n        \"environment_context\": \"Metallic elevator descending rapidly through layers of glowing metamorphic rock and crystalline structures.\",\n        \"optics\": \"24mm wide-angle lens, deep depth of field, sharp focus on the skull's frontal bone.\",\n        \"lighting\": \"Cool industrial cyan lighting inside the elevator contrasting with orange heat glow from outside.\",\n        \"style\": \"Hyper-realistic 3D CGI, cinematic sci-fi aesthetic, vertical 9:16.\"\n      },\n      \"video_prompt\": {\n        \"motion_sequence\": \"The skeleton looks at a digital thermometer rising rapidly, its bony fingers tapping the glass nervously.\",\n        \"character_acting\": \"Subtle rattling of the jaw, expressive eye-lights flickering, looking down through a floor window.\",\n        \"camera_movement\": \"Jittery handheld camera effect to simulate high-speed descent vibration.\",\n        \"vfx_dynamics\": \"Heat haze distortion appearing at the edges of the frame, sparks from the elevator cables.\",\n        \"physics\": \"High-velocity gravity simulation affecting the skeleton's posture.\"\n      }\n    },\n    {\n      \"step\": 2,\n      \"label\": \"The Escalation\",\n      \"voice_over\": \"A mitad de camino, la presiÃ³n es de dos millones de atmÃ³sferas. Tus costillas empezarÃ­an a crujir como ramas secas bajo un camiÃ³n.\",\n      \"image_prompt\": {\n        \"subject_detail\": \"Skeleton struggling to stand, hairline fractures appearing on the humerus and ribs, chrome suit starting to warp.\",\n        \"environment_context\": \"The elevator walls glowing cherry red, molten iron seeping through the door seals.\",\n        \"optics\": \"35mm anamorphic lens, slight chromatic aberration at the edges to simulate intense pressure.\",\n        \"lighting\": \"Harsh red incandescent glow, flickering emergency lights, heavy shadows.\",\n        \"style\": \"Ray-traced reflections on molten metal, photorealistic textures, vertical 9:16.\"\n      },\n      \"video_prompt\": {\n        \"motion_sequence\": \"The skeleton falls to its knees as the ceiling of the elevator begins to sag under extreme pressure.\",\n        \"character_acting\": \"Clenched teeth, hands desperately grasping the railing, trembling movements.\",\n        \"camera_movement\": \"Low-angle tilt up to emphasize the crushing weight of the environment.\",\n        \"vfx_dynamics\": \"Molten metal droplets floating in mid-air due to magnetic interference, heavy steam.\",\n        \"physics\": \"Rigid body destruction simulation on the elevator panels.\"\n      }\n    },\n    {\n      \"step\": 3,\n      \"label\": \"The Chaos\",\n      \"voice_over\": \"Â¡Llegamos al nÃºcleo! AquÃ­ el hierro es lÃ­quido y estÃ¡ a seis mil grados. BÃ¡sicamente, te convertirÃ­as en sopa de calcio instantÃ¡nea.\",\n      \"image_prompt\": {\n        \"subject_detail\": \"Skeleton completely engulfed in white-hot liquid metal, bones becoming incandescent and translucent.\",\n        \"environment_context\": \"A vast ocean of swirling liquid iron, massive magnetic solar-like flares in the background.\",\n        \"optics\": \"50mm macro lens focusing on the skull dissolving into liquid gold-like droplets.\",\n        \"lighting\": \"Extreme volumetric fire lighting, overexposed highlights, lens flares.\",\n        \"style\": \"High-end fluid simulation, 8k resolution, explosive visual impact, vertical 9:16.\"\n      },\n      \"video_prompt\": {\n        \"motion_sequence\": \"The skeleton disintegrates as it floats in the liquid core, bones melting into glowing white particles.\",\n        \"character_acting\": \"A final reach toward the camera before the arm dissolves into a spray of sparks.\",\n        \"camera_movement\": \"Fast-paced orbital rotation around the dissolving character.\",\n        \"vfx_dynamics\": \"Large scale SPH fluid simulation, plasma-like particle effects, white-hot embers.\",\n        \"physics\": \"Melting simulation with high viscosity fluid dynamics.\"\n      }\n    },\n    {\n      \"step\": 4,\n      \"label\": \"The Conclusion\",\n      \"voice_over\": \"Al final, solo serÃ­as un diamante muy caro en el centro de la Tierra. Â¿AÃºn quieres mudarte aquÃ­ o prefieres el aire gratis?\",\n      \"image_prompt\": {\n        \"subject_detail\": \"A single, skull-shaped diamond resting on a bed of cooled, black obsidian rock.\",\n        \"environment_context\": \"Dark, quiet cave in the inner core, subtle glints of light reflecting off the diamond surfaces.\",\n        \"optics\": \"100mm macro lens, extremely shallow depth of field, focus on the diamond skull's eye.\",\n        \"lighting\": \"Single spotlight 'moonlight' effect, ethereal blue glow, sharp caustic reflections.\",\n        \"style\": \"Product-shot quality, elegant and ironic, 8k render, vertical 9:16.\"\n      },\n      \"video_prompt\": {\n        \"motion_sequence\": \"The camera slowly pulls back from the diamond skull as a single wisp of smoke rises from it.\",\n        \"character_acting\": \"Static object but with a 'twinkle' in the diamond eye socket.\",\n        \"camera_movement\": \"Very slow pull-out (reverse dolly) to reveal the emptiness of the core.\",\n        \"vfx_dynamics\": \"Floating dust motes catching the light, subtle heat distortion in the background.\",\n        \"physics\": \"Ray-traced light refraction through the diamond material.\"\n      }\n    }\n  ]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        656,
        112
      ],
      "id": "14638d1e-dda7-4dec-92ab-478d66221856",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -288,
        608
      ],
      "id": "87658d89-df1a-48fb-9956-16c9e4bc244f",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "content": "## Drive Setup",
        "height": 464,
        "width": 608,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -176,
        32
      ],
      "typeVersion": 1,
      "id": "5981e436-e7e6-4d49-bc8c-b54dd4ef9d15",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Scenes Generator",
        "height": 464,
        "width": 512,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        448,
        32
      ],
      "typeVersion": 1,
      "id": "e7661387-4f95-4921-bf3e-706c3d4f4548",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## Generate Content",
        "height": 496,
        "width": 960,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -528,
        528
      ],
      "typeVersion": 1,
      "id": "d0169db7-35b0-46d6-ab58-b36959cb8ff9",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $('Config').item.json.folder_name }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Config').item.json.ideas_hub_folder_id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -128,
        112
      ],
      "id": "4de120c6-fd0c-41b1-be7b-69901e156c6b",
      "name": "Create idea folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "o9FsD2lBiUwRPODM",
          "name": "Hans Acha Brand - Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "=images",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Create idea folder').item.json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        80,
        112
      ],
      "id": "2b7f0f48-a2f6-4f05-bea5-df8b089101c0",
      "name": "Create images folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "o9FsD2lBiUwRPODM",
          "name": "Hans Acha Brand - Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "=videos",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Create idea folder').item.json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -128,
        320
      ],
      "id": "f519d7b8-352f-4760-b5b4-aa20f5c7e06f",
      "name": "Create videos folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "o9FsD2lBiUwRPODM",
          "name": "Hans Acha Brand - Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "Tq4JI39TBeORDFMy",
          "mode": "list",
          "cachedResultUrl": "/workflow/Tq4JI39TBeORDFMy",
          "cachedResultName": "YT  - FFmpeg - Combine Videos Simple"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "input_folder_id": "={{ $('Create narrated videos folder').item.json.id }}",
            "output_folder_id": "={{ $('Create merged video folder').item.json.id }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "input_folder_id",
              "displayName": "input_folder_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "output_folder_id",
              "displayName": "output_folder_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        -96,
        608
      ],
      "id": "41b99835-24a9-4599-b48f-a09050dc3bb1",
      "name": "Call 'YT  - FFmpeg - Combine Videos Simple'",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "jsCode": "const input = $('AI Agent').first().json;\n\n// Mapeamos el arco narrativo para que n8n cree 4 ejecuciones independientes\nreturn input.output.narrative_arc.map((scene, index) => {\n  const step = index + 1;\n\n  return {\n    json: {\n      image_id: `image_step${step}`,\n      // Enviamos el objeto image_prompt completo convertido a String JSON\n      image_prompt: JSON.stringify(scene.image_prompt),\n      \n      audio_id: `audio_step${step}`,\n      // El prompt de audio suele ser el texto del Voice Over\n      audio_prompt: scene.voice_over, \n      \n      video_id: `video_step${step}`,\n      // Enviamos el objeto video_prompt completo convertido a String JSON\n      video_prompt: JSON.stringify(scene.video_prompt),\n    }\n  };\n});\n\nreturn items;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        816,
        320
      ],
      "id": "e9c9d3b5-251d-4bd8-bcb2-bb6d562a4d20",
      "name": "Separate scenes"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -480,
        624
      ],
      "id": "d88e3272-0c5c-4d0c-9dbf-1ec5ed228fc8",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "zkESp5LqbDSNPWNx",
          "mode": "list",
          "cachedResultUrl": "/workflow/zkESp5LqbDSNPWNx",
          "cachedResultName": "YT - Image Style Reference"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "image_prompt": "={{ $('Loop Over Items').item.json.image_prompt }}",
            "folder_reference_id": "={{ $('Config').item.json.reference_folder_id }}",
            "filename_output": "={{ $('Loop Over Items').item.json.image_id }}",
            "folder_output_id": "={{ $('Create images folder').item.json.id }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "image_prompt",
              "displayName": "image_prompt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "folder_reference_id",
              "displayName": "folder_reference_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "filename_output",
              "displayName": "filename_output",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "folder_output_id",
              "displayName": "folder_output_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        -288,
        832
      ],
      "id": "fda89f8a-f610-4f94-95ff-b56667e4facb",
      "name": "Call 'YT - Image Style Reference'",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "4TJ1NM8KpVofeds0",
          "mode": "list",
          "cachedResultUrl": "/workflow/4TJ1NM8KpVofeds0",
          "cachedResultName": "YT - Text to Voice"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "text": "={{ $('Loop Over Items').item.json.audio_prompt }}",
            "file_name": "={{ $('Loop Over Items').item.json.audio_id }}",
            "output_folder_id": "={{ $('Create audios folder').item.json.id }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "text",
              "displayName": "text",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "file_name",
              "displayName": "file_name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "output_folder_id",
              "displayName": "output_folder_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        -96,
        832
      ],
      "id": "d7357086-7606-4903-ba4c-345302ee2248",
      "name": "Call 'YT - Text to Voice'",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "=audios",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Create idea folder').item.json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        288,
        112
      ],
      "id": "f99ba15b-3c4c-4e5d-9cfd-a27c4047937f",
      "name": "Create audios folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "o9FsD2lBiUwRPODM",
          "name": "Hans Acha Brand - Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "=merged_video",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Create idea folder').item.json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        288,
        320
      ],
      "id": "f5d7f5c6-b3e2-40ae-9c8f-2c2f7efc08c8",
      "name": "Create merged video folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "o9FsD2lBiUwRPODM",
          "name": "Hans Acha Brand - Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "ThOe83bae2jvLI4f",
          "mode": "list",
          "cachedResultUrl": "/workflow/ThOe83bae2jvLI4f",
          "cachedResultName": "YT - Image to Video"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "prompt": "={{ $('Loop Over Items').item.json.video_prompt }}",
            "image_id": "={{ $('Call \\'YT - Image Style Reference\\'').item.json.output.id }}",
            "filename_output": "={{ $('Loop Over Items').item.json.video_id }}",
            "folder_output_id": "={{ $('Create videos folder').item.json.id }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "prompt",
              "displayName": "prompt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "image_id",
              "displayName": "image_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "filename_output",
              "displayName": "filename_output",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "folder_output_id",
              "displayName": "folder_output_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        96,
        832
      ],
      "id": "09c67f8d-917c-482d-a0d5-ec5819d436fa",
      "name": "Call 'YT - Image to Video'",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "5LAIj4dExJGd4iPQ",
          "mode": "list",
          "cachedResultUrl": "/workflow/5LAIj4dExJGd4iPQ",
          "cachedResultName": "YT - Combine Video With Voice"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "video_id": "={{ $json.output.id }}",
            "voice_id": "={{ $('Call \\'YT - Text to Voice\\'').item.json.id }}",
            "output_folder_id": "={{ $('Create narrated videos folder').item.json.id }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "video_id",
              "displayName": "video_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "voice_id",
              "displayName": "voice_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "output_folder_id",
              "displayName": "output_folder_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        288,
        832
      ],
      "id": "28c01175-3cba-4184-8a21-334911815547",
      "name": "Call 'YT - Combine Video With Voice'",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "=narrated_video",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Create idea folder').item.json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        80,
        320
      ],
      "id": "a08a3881-404e-4be5-988a-d8724cf15d33",
      "name": "Create narrated videos folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "o9FsD2lBiUwRPODM",
          "name": "Hans Acha Brand - Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Config",
        "height": 464,
        "width": 336,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -528,
        32
      ],
      "typeVersion": 1,
      "id": "a4482aa1-e747-4844-a567-c560f84ae745",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "Mejorar subfluko de combinar (asegurar q siempre borre)\ny probar que funcione aÃ±adiendo extensiones, actualizar repo\n\n\nImagen de referencia se esta usando ahora 9:16, acutalizar repo\n\n\nMejorar el guion del resutlado final",
        "height": 176,
        "width": 464
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2320,
        96
      ],
      "typeVersion": 1,
      "id": "d734cf64-3db7-433e-8232-5cb106b5d539",
      "name": "Sticky Note4"
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking â€˜Execute workflowâ€™": {
      "main": [
        [
          {
            "node": "Config",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Config": {
      "main": [
        [
          {
            "node": "Create idea folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Separate scenes",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Call 'YT  - FFmpeg - Combine Videos Simple'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create idea folder": {
      "main": [
        [
          {
            "node": "Create images folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create images folder": {
      "main": [
        [
          {
            "node": "Create audios folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create videos folder": {
      "main": [
        [
          {
            "node": "Create narrated videos folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Separate scenes": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Call 'YT - Image Style Reference'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'YT - Image Style Reference'": {
      "main": [
        [
          {
            "node": "Call 'YT - Text to Voice'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create audios folder": {
      "main": [
        [
          {
            "node": "Create videos folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create merged video folder": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'YT - Text to Voice'": {
      "main": [
        [
          {
            "node": "Call 'YT - Image to Video'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'YT - Image to Video'": {
      "main": [
        [
          {
            "node": "Call 'YT - Combine Video With Voice'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create narrated videos folder": {
      "main": [
        [
          {
            "node": "Create merged video folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'YT - Combine Video With Voice'": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "567fd559-d875-4d22-9926-481e4f7cd86e",
  "meta": {
    "instanceId": "b8b926503e69b4d6452ef4997e517f018d779566da930bb3e134ea773821cffd"
  },
  "id": "6HoDN3bKvCDbqWki",
  "tags": []
}